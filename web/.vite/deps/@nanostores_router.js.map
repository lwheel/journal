{
  "version": 3,
  "sources": ["../../node_modules/.pnpm/@nanostores+router@0.15.0_nanostores@0.10.3/node_modules/@nanostores/router/index.js"],
  "sourcesContent": ["import { atom, onMount } from 'nanostores'\n\nexport function createRouter(routes, opts = {}) {\n  let router = atom()\n  router.routes = Object.keys(routes).map(name => {\n    let value = routes[name]\n\n    if (typeof value !== 'string') {\n      return [name, ...[value].flat()]\n    }\n\n    value = value.replace(/\\/$/g, '') || '/'\n\n    let pattern = value\n      .replace(/[\\s!#$()+,.:<=?[\\\\\\]^{|}]/g, '\\\\$&')\n      .replace(/\\/\\\\:(\\w+)\\\\\\?/g, '(?:/(?<$1>(?<=/)[^/]+))?')\n      .replace(/\\/\\\\:(\\w+)/g, '/(?<$1>[^/]+)')\n\n    return [\n      name,\n      RegExp('^' + pattern + '$', 'i'),\n      null,\n      value\n    ];\n  })\n\n  let prev\n  let parse = path => {\n    path = path.replace(/\\/($|\\?)/, '$1') || '/'\n    if (prev === path) return false\n    prev = path\n\n    let url = new URL(path, 'http://a')\n    if (!opts.search) path = url.pathname\n\n    for (let [route, pattern, callback] of router.routes) {\n      let match = path.match(pattern)\n      if (match) {\n        return {\n          // If route has callback for params decoding use it. Otherwise decode params from named capture groups\n          params: callback ? callback(...match.slice(1)) : Object.keys({...match.groups}).reduce((pars, key) => {\n            // match === undefined when nothing captured in regexp group\n            // and we swap it with empty string for backward compatibility\n            pars[key] = match.groups[key] ? decodeURIComponent(match.groups[key]) : '';\n            return pars\n          }, {}),\n          path,\n          route,\n          search: Object.fromEntries(url.searchParams)\n        }\n      }\n    }\n  }\n\n  let click = event => {\n    let link = event.target.closest('a')\n    if (\n      link &&\n      event.button === 0 && // Left mouse button\n      link.target !== '_blank' && // Not for new tab\n      link.origin === location.origin && // Not external link\n      link.rel !== 'external' && // Not external link\n      link.target !== '_self' && // Now manually disabled\n      !link.download && // Not download link\n      !event.altKey && // Not download link by user\n      !event.metaKey && // Not open in new tab by user\n      !event.ctrlKey && // Not open in new tab by user\n      !event.shiftKey && // Not open in new window by user\n      !event.defaultPrevented // Click was not cancelled\n    ) {\n      event.preventDefault()\n      let changed = location.hash !== link.hash\n      router.open(link.pathname + link.search)\n      if (changed) {\n        location.hash = link.hash\n        if (link.hash === '' || link.hash === '#') {\n          window.dispatchEvent(new HashChangeEvent('hashchange'))\n        }\n      }\n    }\n  }\n\n  let set = router.set\n  if (process.env.NODE_ENV !== 'production') {\n    delete router.set\n  }\n\n  let popstate = () => {\n    let page = parse(location.pathname + location.search)\n    if (page !== false) set(page)\n  }\n\n  if (typeof window !== 'undefined' && typeof location !== 'undefined') {\n    onMount(router, () => {\n      let page = parse(location.pathname + location.search)\n      if (page !== false) set(page)\n      if (opts.links !== false) document.body.addEventListener('click', click)\n      window.addEventListener('popstate', popstate)\n      return () => {\n        prev = undefined\n        document.body.removeEventListener('click', click)\n        window.removeEventListener('popstate', popstate)\n      }\n    })\n  } else {\n    set(parse('/'))\n  }\n\n  router.open = (path, redirect) => {\n    let page = parse(path)\n    if (page !== false) {\n      if (typeof history !== 'undefined') {\n        if (redirect) {\n          history.replaceState(null, null, path)\n        } else {\n          history.pushState(null, null, path)\n        }\n      }\n      set(page)\n    }\n  }\n\n  return router\n}\n\nexport function getPagePath(router, name, params, search) {\n  if (typeof name === 'object') {\n    search = params\n    params = name.params\n    name = name.route\n  }\n  let route = router.routes.find(i => i[0] === name)\n  if (process.env.NODE_ENV !== 'production') {\n    if (!route[3]) throw new Error('RegExp routes are not supported')\n  }\n  let path = route[3]\n    .replace(/\\/:\\w+\\?/g, i => {\n      let param = params ? params[i.slice(2).slice(0, -1)] : null\n      if (param) {\n        return '/' + encodeURIComponent(param)\n      } else {\n        return ''\n      }\n    })\n    .replace(/\\/:\\w+/g, i => '/' + encodeURIComponent(params[i.slice(2)]))\n  let postfix = ''\n  if (search) {\n    postfix = '' + new URLSearchParams(search)\n    if (postfix) postfix = '?' + postfix\n  }\n  return (path || '/') + postfix\n}\n\nexport function openPage(router, name, params, search) {\n  router.open(getPagePath(router, name, params, search))\n}\n\nexport function redirectPage(router, name, params, search) {\n  router.open(getPagePath(router, name, params, search), true)\n}\n"],
  "mappings": "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",
  "names": []
}
